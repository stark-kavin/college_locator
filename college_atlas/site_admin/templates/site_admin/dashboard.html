<!DOCTYPE html>
{% load static %}
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Uniform Simple College List</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;family=Lexend:wght@400;600;700&amp;display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "navy": {
                            "50": "#f8fafc",
                            "100": "#f1f5f9",
                            "200": "#e2e8f0",
                            "300": "#cbd5e1",
                            "400": "#94a3b8",
                            "500": "#64748b",
                            "600": "#475569",
                            "700": "#334155",
                            "800": "#1e293b",
                            "900": "#0f172a",
                            "950": "#020617",
                        },
                        "edu-primary": "#0f172a", // Deep Navy
                        "edu-accent": "#2563eb", // Professional Blue
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.375rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem"
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply bg-[#fcfcfd] text-navy-900;
            }
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .nav-item-active {
            @apply bg-navy-800 text-white;
        }
        .nav-item {
            @apply flex items-center gap-3 px-4 py-3 rounded-lg text-navy-400 hover:text-white hover:bg-navy-800/50 transition-all duration-200;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            @apply bg-transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            @apply bg-navy-700/20 rounded-full;
        }
    </style>
</head>

<body class="font-sans antialiased">
    <div class="flex h-screen overflow-hidden">
        {% include 'site_admin/partials/sidebar.html' with active='colleges' %}
        <main class="flex-1 flex flex-col overflow-y-auto">
            <header
                class="h-20 bg-white border-b border-navy-100 flex items-center justify-between px-10 sticky top-0 z-20">
                <div class="flex items-center gap-4">
                    <nav class="flex items-center gap-2 text-sm">
                        <a class="text-navy-400 hover:text-navy-900 transition-colors" href="#">Home</a>
                        <span class="material-symbols-outlined text-navy-300 text-sm">chevron_right</span>
                        <span class="font-semibold text-navy-900">Colleges</span>
                    </nav>
                </div>
                <div class="flex items-center gap-3">
                    <a href="{% url 'create_college' %}"
                        class="bg-navy-900 text-white text-sm font-semibold h-10 px-5 rounded-lg flex items-center gap-2 hover:bg-navy-800 transition-all active:scale-95 shadow-lg shadow-navy-900/10">
                        <span class="material-symbols-outlined text-[20px]">add</span>
                        Add College
                    </a>
                </div>
            </header>
            <div class="px-10 py-8 max-w-7xl">
                <div class="mb-10">
                    <h2 class="text-2xl font-bold text-navy-950 font-display">College List</h2>
                    <p class="text-navy-500 text-sm mt-1">Manage the master list of colleges and their administrative
                        details.</p>
                </div>
                <div class="bg-white rounded-2xl border border-navy-100 shadow-sm mb-8 overflow-hidden">
                    <div class="p-5 flex flex-wrap items-center justify-between gap-4">
                        <div class="relative flex-1 min-w-[320px] max-w-lg">
                            <form method="get" class="w-full">
                                <span
                                    class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-navy-400">search</span>
                                <input
                                    name="search"
                                    value="{{ search_query }}"
                                    class="w-full bg-navy-50/50 border-navy-100 rounded-xl py-2.5 pl-11 pr-4 focus:ring-2 focus:ring-edu-accent/10 focus:border-edu-accent outline-none text-sm transition-all placeholder:text-navy-400"
                                    placeholder="Search by name or district..." type="text" />
                            </form>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="flex items-center gap-2 bg-navy-50/80 border border-navy-100 p-1 rounded-xl">
                                <select name="district" onchange="applyFilter()" id="districtFilter" class="px-4 py-2 text-xs font-semibold text-navy-600 bg-transparent border-0 rounded-lg outline-none cursor-pointer">
                                    <option value="">All Districts</option>
                                    {% for district in districts %}
                                    <option value="{{ district.id }}" {% if district_filter == district.id|stringformat:"s" %}selected{% endif %}>
                                        {{ district.name }}, {{ district.state.name }}
                                    </option>
                                    {% endfor %}
                                </select>
                                <select name="college_type" onchange="applyFilter()" id="collegeTypeFilter" class="px-4 py-2 text-xs font-semibold bg-white text-navy-950 border-0 rounded-lg outline-none cursor-pointer shadow-sm ring-1 ring-navy-100">
                                    <option value="">All Types</option>
                                    {% for value, label in college_types %}
                                    <option value="{{ value }}" {% if college_type_filter == value %}selected{% endif %}>{{ label }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-navy-50/50 border-y border-navy-100">
                                    <th class="px-6 py-4 text-[11px] font-bold text-navy-500 uppercase tracking-widest">
                                        Name</th>
                                    <th class="px-6 py-4 text-[11px] font-bold text-navy-500 uppercase tracking-widest">
                                        University</th>
                                    <th class="px-6 py-4 text-[11px] font-bold text-navy-500 uppercase tracking-widest">
                                        College Type</th>
                                    <th class="px-6 py-4 text-[11px] font-bold text-navy-500 uppercase tracking-widest">
                                        District</th>
                                    <th
                                        class="px-6 py-4 text-[11px] font-bold text-navy-500 uppercase tracking-widest text-right">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-navy-50">
                                {% for college in page_obj %}
                                <tr class="hover:bg-navy-50/30 transition-colors group">
                                    <td class="px-6 py-5">
                                        <div class="flex items-center gap-3">
                                            <div
                                                class="size-10 bg-navy-900 rounded-lg flex items-center justify-center text-white shadow-sm">
                                                <span
                                                    class="material-symbols-outlined text-[20px]">account_balance</span>
                                            </div>
                                            <div>
                                                <p class="text-sm font-semibold text-navy-950">{{ college.name }}</p>
                                                <p class="text-[11px] text-navy-400 font-mono">#CN-{{ college.id|stringformat:"06d" }}</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-5 text-sm text-navy-600">
                                        {% if college.university %}{{ college.university }}{% else %}<span class="text-navy-400">-</span>{% endif %}
                                    </td>
                                    <td class="px-6 py-5">
                                        <span
                                            class="inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider 
                                            {% if college.college_type == 'eng' %}bg-blue-50 text-blue-700 border border-blue-100
                                            {% elif college.college_type == 'arts' %}bg-purple-50 text-purple-700 border border-purple-100
                                            {% elif college.college_type == 'med' %}bg-emerald-50 text-emerald-700 border border-emerald-100
                                            {% else %}bg-slate-50 text-slate-700 border border-slate-100{% endif %}">
                                            {{ college.get_college_type_display }}
                                        </span>
                                    </td>
                                    <td class="px-6 py-5 text-sm text-navy-600 font-medium">{{ college.district.name }}, {{ college.district.state.name }}</td>
                                    <td class="px-6 py-5 text-right">
                                        <div class="flex items-center justify-end gap-1">
                                            <a href="{% url 'edit_college' college.pk %}"
                                                class="p-1.5 text-navy-400 hover:text-navy-900 hover:bg-navy-100 rounded transition-all">
                                                <span class="material-symbols-outlined text-[20px]">edit</span>
                                            </a>
                                            <form method="post" action="{% url 'delete_college' college.pk %}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete {{ college.name }}?');">
                                                {% csrf_token %}
                                                <button type="submit"
                                                    class="p-1.5 text-navy-400 hover:text-red-600 hover:bg-red-50 rounded transition-all">
                                                    <span class="material-symbols-outlined text-[20px]">delete</span>
                                                </button>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="px-6 py-12 text-center">
                                        <div class="flex flex-col items-center justify-center text-navy-400">
                                            <span class="material-symbols-outlined text-5xl mb-3">search_off</span>
                                            <p class="text-sm font-medium">No colleges found</p>
                                            <p class="text-xs mt-1">Try adjusting your search or filters</p>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="bg-navy-50/30 px-6 py-4 flex items-center justify-between border-t border-navy-100">
                        <p class="text-xs text-navy-500 font-medium uppercase tracking-tight">
                            Displaying <span class="text-navy-950 font-bold">{{ page_obj.start_index }} - {{ page_obj.end_index }}</span> of <span
                                class="text-navy-950 font-bold">{{ page_obj.paginator.count }}</span> records
                        </p>
                        <div class="flex items-center gap-1">
                            {% if page_obj.has_previous %}
                            <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if college_type_filter %}&college_type={{ college_type_filter }}{% endif %}{% if district_filter %}&district={{ district_filter }}{% endif %}"
                                class="size-8 flex items-center justify-center rounded-lg text-navy-400 hover:bg-navy-100 transition-colors">
                                <span class="material-symbols-outlined text-[20px]">chevron_left</span>
                            </a>
                            {% else %}
                            <span class="size-8 flex items-center justify-center rounded-lg text-navy-200 cursor-not-allowed">
                                <span class="material-symbols-outlined text-[20px]">chevron_left</span>
                            </span>
                            {% endif %}
                            
                            {% for num in page_obj.paginator.page_range %}
                                {% if page_obj.number == num %}
                                <span class="size-8 flex items-center justify-center rounded-lg bg-navy-900 text-white text-xs font-bold shadow-sm">{{ num }}</span>
                                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                                <a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if college_type_filter %}&college_type={{ college_type_filter }}{% endif %}{% if district_filter %}&district={{ district_filter }}{% endif %}"
                                    class="size-8 flex items-center justify-center rounded-lg text-navy-600 hover:bg-navy-100 text-xs font-bold transition-colors">{{ num }}</a>
                                {% endif %}
                            {% endfor %}
                            
                            {% if page_obj.has_next %}
                            <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if college_type_filter %}&college_type={{ college_type_filter }}{% endif %}{% if district_filter %}&district={{ district_filter }}{% endif %}"
                                class="size-8 flex items-center justify-center rounded-lg text-navy-400 hover:bg-navy-100 transition-colors">
                                <span class="material-symbols-outlined text-[20px]">chevron_right</span>
                            </a>
                            {% else %}
                            <span class="size-8 flex items-center justify-center rounded-lg text-navy-200 cursor-not-allowed">
                                <span class="material-symbols-outlined text-[20px]">chevron_right</span>
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    {% if messages %}
    <div class="fixed top-4 right-4 z-50 space-y-2">
        {% for message in messages %}
        <div class="bg-white border-l-4 {% if message.tags == 'success' %}border-emerald-500{% elif message.tags == 'error' %}border-red-500{% else %}border-blue-500{% endif %} rounded-lg shadow-lg p-4 max-w-md animate-slide-in">
            <div class="flex items-start gap-3">
                <span class="material-symbols-outlined {% if message.tags == 'success' %}text-emerald-500{% elif message.tags == 'error' %}text-red-500{% else %}text-blue-500{% endif %}">
                    {% if message.tags == 'success' %}check_circle{% elif message.tags == 'error' %}error{% else %}info{% endif %}
                </span>
                <div class="flex-1">
                    <p class="text-sm font-semibold text-slate-900">{{ message }}</p>
                </div>
                <button onclick="this.parentElement.parentElement.remove()" class="text-slate-400 hover:text-slate-600">
                    <span class="material-symbols-outlined text-[20px]">close</span>
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <script>
        function applyFilter() {
            const searchParams = new URLSearchParams(window.location.search);
            const districtFilter = document.getElementById('districtFilter').value;
            const collegeTypeFilter = document.getElementById('collegeTypeFilter').value;
            
            if (districtFilter) {
                searchParams.set('district', districtFilter);
            } else {
                searchParams.delete('district');
            }
            
            if (collegeTypeFilter) {
                searchParams.set('college_type', collegeTypeFilter);
            } else {
                searchParams.delete('college_type');
            }
            
            searchParams.delete('page');
            window.location.search = searchParams.toString();
        }

        setTimeout(() => {
            document.querySelectorAll('.animate-slide-in').forEach(el => {
                el.style.transition = 'opacity 0.5s';
                el.style.opacity = '0';
                setTimeout(() => el.remove(), 500);
            });
        }, 5000);
    </script>

</body>

</html>